{% extends "app/base.html" %}
{% load static %}
{% load socialaccount %}

{% block head_title %}{{ user.username }} | ClipHype{% endblock %}

{% block content %}
<div id="app" v-cloak>
<div class="container">
    <!-- SEARCH STREAMER -->
    <div class="section" id="search">
        <label class="row mt-2 mb-3">
            <div class="col-sm-2">
                <h3 class="text-dark font-weight-bold">Streamer</h3>
            </div>
            <div class="col-sm">
                <input type="text" v-model="streamerName" class="input-lg border rounded shadow-sm pl-2 py-1" placeholder="shroud" required>
                <button class="btn btn-outline-primary ml-2 px-2 shadow-sm" v-on:click="getStreamerId">
                    <i class="fas fa-search"></i>
                </button>
            </div>
        </label>
    </div>
    <!-- /SERACH STREAMER -->

    <!-- FOLLOWS CHANNEL -->
    <div class="mt-2 section" id="follows" v-show="clientId.length !== 0">
        <h1>
            <a class="text-dark text-decoration-none font-weight-bold" tabindex="-1" href="#follows" data-toggle="tooltip" title="Click icon to show selected streamer's clips" data-placement="right">
            Follow Channels
            </a>
        </h1>
        <div class="row justify-content-center my-2">
            <paginate class="justify-content-center" v-model="followsCurrentPage"
                    :page-count="getFollowsPageCount"
                    :page-range="0"
                    :margin-pages="0"
                    :click-handler="clickFollowsCallback"
                    :prev-text="'<'"
                    :next-text="''"
                    :break-view-text="''"
                    :container-class="'pagination'"
                    :prev-class="'page-item'"
                    :prev-link-class="'page-link rounded-circle mt-3 mr-2 bg-light shadow-sm'"
                    >
            </paginate>
        <div class="bg-light rounded ml-1" v-for="item in getFollowsItems">
            <div class="card bg-light border-0">
                <a v-on:click="streamerName = item.to_login; streamerId = item.to_id;" style="cursor: pointer">
                <div class="card-img">
                    <img class="rounded-circle img-fluid shadow" v-bind:src="item.profile_image_url" width="70">
                </div>
                <div class="card-img-overlay streamer-img">
                    <div class="card-text">
                        <button type="button" class="position-absolute channel-count badge badge-pill badge-secondary text-light" v-show="item.autoclip_count>0" data-toggle="tooltip" data-placement="right" title="The number of auto generated clips in 24 hours">
                            [[ item.autoclip_count ]]
                        </button>
                        <span class="position-absolute w-100 channel-badge text-center text-secondary badge badge-pill badge-light shadow border border-secondary overflow-hidden font-weight-bold">
                            [[ item.to_login ]]
                        </span>
                    </div>
                </div>
                </a>
            </div>
        </div>
            <paginate class="justify-content-center" v-model="followsCurrentPage"
                    :page-count="getFollowsPageCount"
                    :page-range="0"
                    :margin-pages="0"
                    :click-handler="clickFollowsCallback"
                    :prev-text="''"
                    :next-text="'>'"
                    :break-view-text="''"
                    :container-class="'pagination'"
                    :next-class="'page-item'"
                    :next-link-class="'page-link rounded-circle mt-3 ml-2 bg-light shadow-sm'"
                    >
            </paginate>
        </div>
    </div>
    <!-- /FOLLOWS CHANNEL -->

    <!-- ARCHIVE AREA -->
    <div class="p-3 shadow mt-4 mb-4 bg-white section" id="archive">
        <h2>
            <a class="text-dark text-decoration-none font-weight-bold" role="button" href="#archive" data-toggle="tooltip" title="Click archive to show clips created during the stream" data-placement="right">
            Channel Archive
            </a>
        </h2>
    <div class="row justify-content-center text-white">
            <paginate class="justify-content-center mt-4" v-model="videosCurrentPage"
                    :page-count="getVideosPageCount"
                    :page-range="0"
                    :margin-pages="0"
                    :click-handler="clickVideosCallback"
                    :prev-text="'<'"
                    :next-text="''"
                    :break-view-text="''"
                    :container-class="'pagination'"
                    :prev-class="'page-item'"
                    :prev-link-class="'page-link rounded-circle mt-3 mr-2 bg-light shadow-sm'"
                    >
            </paginate>
        <div class="bg-dark m-1" v-for="item in getVideosItems">
            <div class="card border-0 shadow">
                <a href="#archive" v-on:click="setArchiveDate(item)">
                <div class="card-img">
                    <img class="" v-bind:src="item.thumbnail_url" width="200">
                </div>
                <div class="card-img-overlay archive-img text-white">
                    <div class="card-text archive-text overflow-hidden">
                        <span class="badge archive-title rounded p-1">[[ item.title ]]</span>
                    </div>
                        <div class="archive-bottom">
                            <div class="badge archive-duration rounded">[[ item.duration ]]</div>
                            <div class="badge archive-date rounded">[[ item.date ]]</div>
                        </div>
                </div>
                </a>
            </div>
        </div>
            <paginate class="justify-content-center mt-4" v-model="videosCurrentPage"
                    :page-count="getVideosPageCount"
                    :page-range="0"
                    :margin-pages="0"
                    :click-handler="clickVideosCallback"
                    :prev-text="''"
                    :next-text="'>'"
                    :break-view-text="''"
                    :container-class="'pagination'"
                    :next-class="'page-item'"
                    :next-link-class="'page-link rounded-circle mt-3 ml-2 bg-light shadow-sm'"
                    >
            </paginate>
        </div>
    </div>
    <!-- /ARCHIVE AREA -->

    <!-- CLIPS AREA -->
    <div class="shadow section bg-white" id="clips">
        <div class="row m-1">
            <div class="col border-0">
                <nav aria-label="Page navigation">
                    <nav class="navbar navbar-dark text-dark">
                        <div class="row">
                            <button class="btn btn-outline-primary font-weight-bold" data-toggle="button" v-on:click="published = !published">Published</button>
                            <button class="btn btn-outline-primary ml-2 font-weight-bold" data-toggle="button" v-on:click="autoclipped = !autoclipped">AutoClipped</button>
                            <button type="button" class="btn btn-success ml-2 font-weight-bold" v-on:click="getAfterClips">More</button>
                        </div>
                        <div class="row py-2">
                            <datepicker
                                    v-model="datepickerStartedAt"
                                    @input="formatDatepickerStartedAt()"
                                    :format="DatePickerFormat"
                                    name="datepickerStartedAt"
                                    class="d-inline-flex mr-2 py-1">
                            </datepicker>
                            <span class="text-center mt-2 font-weight-bold">~</span>
                            <datepicker
                                    v-model="datepickerEndedAt"
                                    @input="formatDatepickerEndedAt()"
                                    :format="DatePickerFormat"
                                    name="datepickerEndedAt"
                                    class="d-inline-flex ml-2 py-1">
                            </datepicker>
                            <button type="button" v-on:click="getClips" class="btn btn-primary ml-2 shadow-sm font-weight-bold">Search</button>
                        </div>
                    </nav>
                <paginate class="justify-content-center" v-model="clipsCurrentPage"
                    :page-count="getClipsPageCount"
                    :page-range="3"
                    :margin-pages="2"
                    :click-handler="clickClipsCallback"
                    :prev-text="'<'"
                    :next-text="'>'"
                    :container-class="'pagination'"
                    :page-class="'page-item'"
                    :prev-class="'page-item'"
                    :next-class="'page-item'"
                    :page-link-class="'page-link'"
                    :prev-link-class="'page-link'"
                    :next-link-class="'page-link'">
                </paginate>
                <div class="row">
                    <div class="my-2 col-lg-6 col-xl-4" v-for="item in getClipsItems">
                        <form action="{% url 'download' %}" method="post">
                        {% csrf_token %}
                        <div class="card border-0 rounded shadow bg-light">
                            <div class="card border-0">
                                <a v-on:click="openClipModal(item.embed_url)" style="cursor: pointer">
                                    <img class="card-img" v-bind:src="item.thumbnail_url">
                                <div class="card-img-overlay">
                                    <p class="card-text text-white overflow-hidden text-title-parent">
                                    <span class="text-title badge badge-dark px-1 font-weight-bold">[[ item.title ]]</span>
                                </p>
                                    <div class="h-100 d-flex flex-column justify-content-end">
                                        <div class="d-flex justify-content-between">
                                            <div class="mb-1 text-white text-views rounded px-1 font-weight-bold">views:[[ item.view_count ]]</div>
                                            <div v-show="item.hype" class="mb-1 text-white text-hype rounded px-1 font-weight-bold">hype:[[ item.hype ]]</div>
                                            <div class="mb-1 text-white text-date rounded px-1 font-weight-bold">[[ item.created_date ]]</div>
                                        </div>
                                    </div>
                                </div>
                                </a>
                            </div>
                            <div class="card-body mt-1">
                                <button type="submit" class="btn btn-outline-success rounded shadow-sm" name="id" v-bind:value="item.id"><i class="fas fa-download" style="font-size: 1.0em"></i></button>
                                <button type="button" class="btn btn-outline-info rounded shadow-sm ml-2" v-on:click="appendClip(item)" v-if="!isSelectedClip(item)">
                                    <i class="fas fa-plus"></i>
                                </button>
                                <button type="button" class="btn btn-info rounded shadow-sm ml-2" v-on:click="deleteClip(item)" v-else>
                                    <i class="fas fa-check"></i>
                                </button>
                            </div>
                        </div>
                        </form>
                    </div>
                    <div class="modal fade" id="clipModal" tabindex="-1" role="dialog" aria-labelledby="label1" aria-hidden="true">
                        <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
                            <div class="modal-content bg-dark">
                                <div class="embed-responsive embed-responsive-16by9">
                                <iframe class="embed-responsive-item"
                                                v-bind:src="clipEmbedUrl"
                                                frameborder="0"
                                                scrolling="no">
                                </iframe>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <paginate class="justify-content-center mt-3" v-model="clipsCurrentPage"
                :page-count="getClipsPageCount"
                :page-range="3"
                :margin-pages="2"
                :click-handler="clickClipsCallback"
                :prev-text="'<'"
                :next-text="'>'"
                :container-class="'pagination'"
                :page-class="'page-item'"
                :prev-class="'page-item'"
                :next-class="'page-item'"
                :page-link-class="'page-link'"
                :prev-link-class="'page-link'"
                :next-link-class="'page-link'">
                </paginate>
                </nav>
            </div>
        </div>
    </div>
    <!-- /CLIPS AREA -->

    <!-- TIMELINE AREA -->
    <section id="timeline">
    <div class="p-3 my-4 shadow section bg-white">
    <div class="row pt-2">
        <div class="col pb-3">
            <h2>
                <a class="text-dark text-decoration-none font-weight-bold" role="button" href="#timeline" data-toggle="tooltip" title="Create a video from inserted clips" data-placement="right">
                Clips to Highlight
                </a>
            </h2>
            <span class="text-secondary ml-2 mb-1">
                Press
                <span class="btn btn-sm btn-outline-info rounded shadow-sm mx-1"><i class="fas fa-plus" style="font-size: 0.9em"></i></span>
                button to add a clip
            </span>
            <p class="text-secondary mt-2">
                <button class="btn btn-secondary ml-2" data-toggle="collapse" data-target="#timelineNote"
                        aria-expand="false" aria-controls="digestNote">
                    <i class="fas fa-exclamation-circle pt-1" style="font-size: 1.3em"></i>
                    <span class="ml-1">Note</span>
                </button>
                <div class="collapse shadow-sm p-3 bg-light" id="timelineNote">
                    <span class="d-block">
                        ・The highlights video can be up to 10 minutes long.
                    </span>
                    <span class="d-block">
                        ・This process which create a highlights video takes more than 10 minutes.
                    </span>
                </div>
            </p>
            <div class="mt-2">
                <button class="btn btn-info" v-on:click="sortTimelineClipsByDatetime">
                    <i class="fas fa-sort-amount-down-alt"></i>
                    <i class="far fa-clock"></i>
                </button>
            </div>
        </div>
    </div>
        <div class="row px-3 pt-2 pb-3 m-1 shadow-sm rounded-lg bg-light">
            <div class="col-12">
            <p class="text-dark font-weight-bold">
                <span>
                    Current Clips : [[ timelineClips.length ]]
                </span>
                <span class="ml-2">
                    <span v-bind:class="{ 'text-danger': playTimeExceeded }">
                    Length : [[ getTotalClipSeconds ]]
                    </span>
                </span>
                <!--
                {% if not isGoogleConnect %}
                <a href="{% provider_login_url "google" process="connect" %}">
                    <button type="button" class="btn btn-danger">Youtube Connect</button>
                </a>
                {% endif %}
                -->
            </p>
            </div>
            <button type="button" class="btn btn-outline-dark mr-1 ml-4" v-on:click="prevClip">＜</button>
            <div v-for="(item, index) in getTimelineItems" class="border border-secondary">
                <div class="card border-0" v-on:mouseover="item.isHover = true" v-on:mouseleave="item.isHover = false">
                    <div class="card-img">
                        <img v-bind:src="item.thumbnail_url" width="120">
                    </div>
                    <div class="card-img-overlay">
                        <span class="font-weight-bold font-italic text-light timelineIndex">[[ index + timelinePageIndex + 1 ]]</span>
                        <div v-show="item.isHover">
                            <a class="timelinePlay" v-on:click="openTimelineModal(item.embed_url, index + timelinePageIndex)"><i class="far fa-play-circle text-light"></i></a>
                            <a class="timelineMenu" v-on:click="clickSelectedClipMenu(item)"><i class="fas fa-ellipsis-v text-light"></i></a>
                            <a class="timelineRemove" v-on:click="removeTimelineClip(index + timelinePageIndex)"><i class="fas fa-times-circle text-danger"></i></a>
                            <a class="timelinePrev" v-on:click="movePrevTimelineClip(index + timelinePageIndex)"><i class="fas fa-arrow-circle-left text-warning"></i></a>
                            <a class="timelineNext" v-on:click="moveNextTimelineClip(index + timelinePageIndex)"><i class="fas fa-arrow-circle-right text-warning"></i></a>
                        </div>
                    </div>
                </div>
                <div class="position-absolute" v-show="item.showMenu">
                    <span class="badge bg-light">
                        Title:
                        <input class="input-sm border rounded shadow-sm" v-model="item.title">
                    </span>
                </div>
            </div>
            <button type="button" class="btn btn-outline-dark ml-1" v-on:click="nextClip">＞</button>

            <div class="modal fade" id="timelineModal" tabindex="-1" role="dialog" aria-labelledby="label1" aria-hidden="true">
                <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
                    <div class="modal-content bg-black">
                        <div class="d-inline-flex my-1">
                            <div class="d-flex align-items-center badge bg-dark px-3 ml-2 rounded-pill">
                                <span class="px-3 py-1 font-weight-bold text-light" style="font-size: 20px;">
                                    [[ selectedClipModalIndex+1 ]]
                                </span>
                            </div>
                            <div class="ml-2">
                                <input class="px-2 py-1 bg-dark text-light input-lg border rounded shadow-sm" v-model="selectedClipTitle">
                            </div>
                            <a class="ml-3 btn bg-success" v-bind:href="selectedClipEditURL" v-show="selectedClipEditableTime !== 0" target="_blank">
                                <i class="fas fa-cut"></i>
                                <span class="ml-2">[[ formattedEditableTime ]]</span>
                            </a>
                            <a class="timelineModalRemove mt-1 mr-2" v-on:click="removeTimelineClipModal(selectedClipModalIndex)">
                                <i class="fas fa-trash-alt text-danger"></i>
                            </a>
                        </div>
                        <div class="embed-responsive embed-responsive-16by9">
                        <iframe class="embed-responsive-item"
                                        v-bind:src="timelineEmbedUrl"
                                        frameborder="0"
                                        scrolling="no">
                        </iframe>
                        </div>
                        <div class="mx-auto">
                            <a class="mr-4 display-4" style="cursor: pointer;" v-on:click="openPrevSelectedClip"><i class="fas fa-angle-left text-light"></i></a>
                            <a class="ml-4 display-4" style="cursor: pointer;" v-on:click="openNextSelectedClip"><i class="fas fa-angle-right text-light"></i></a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </section>
    <!-- /TIMELINE AREA -->
    <!-- DIGEST OPTION -->
    <section id="options">
        <div class="p-3 my-4 shadow section bg-white">
            <div class="row p-3">
                <div class="col-lg-8">
                <div class="bg-light p-3 rounded shadow-sm">
                    <h3 class="text-dark font-weight-bold">Title</h3>
                    <input type="text" v-model="title" @input="evalCanCreateHighlights()" class="input-lg border rounded shadow-sm py-1" required>
                <div class="mt-3">
                    <div class="d-inline-flex">
                        <h3 class="text-dark font-weight-bold">Transition</h3>
                        <a href="https://gl-transitions.com/gallery" target="_blank"><h5 class="font-weight-bold ml-2 pt-2">Gallery</h5></a>
                    </div>
                    <select class="form-control shadow-sm border" v-model="transition">
                        <option>Bounce</option>
                        <option>BowTieHorizontal</option>
                        <option>BowTieVertical</option>
                        <option>ButterflyWaveScrawler</option>
                        <option>CircleCrop</option>
                        <option>ColourDistance</option>
                        <option>CrazyParametricFun</option>
                        <option>CrossZoom</option>
                        <option>Directional</option>
                        <option>DoomScreenTransition</option>
                        <option>Dreamy</option>
                        <option>DreamyZoom</option>
                        <option>FilmBurn</option>
                        <option>GlitchDisplace</option>
                        <option>GlitchMemories</option>
                        <option>GridFlip</option>
                        <option>InvertedPageCurl</option>
                        <option>LinearBlur</option>
                        <option>Mosaic</option>
                        <option>PolkaDotsCurtain</option>
                        <option>Radial</option>
                        <option>SimpleZoom</option>
                        <option>StereoViewer</option>
                        <option>Swirl</option>
                        <option>TVStatic</option>
                        <option>WaterDrop</option>
                        <option>ZoomInCircles</option>
                        <option>angular</option>
                        <option>burn</option>
                        <option>cannabisleaf</option>
                        <option>circle</option>
                        <option>circleopen</option>
                        <option>colorphase</option>
                        <option>crosshatch</option>
                        <option>crosswarp</option>
                        <option>cube</option>
                        <option>directionalwarp</option>
                        <option>directionalwipe</option>
                        <option>displacement</option>
                        <option>doorway</option>
                        <option>fade</option>
                        <option>fadecolor</option>
                        <option>fadegrayscale</option>
                        <option>flyeye</option>
                        <option>heart</option>
                        <option>hexagonalize</option>
                        <option>kaleidoscope</option>
                        <option>luma</option>
                        <option>luminance_melt</option>
                        <option>morph</option>
                        <option>multiply_blend</option>
                        <option>perlin</option>
                        <option>pinwheel</option>
                        <option>pixelize</option>
                        <option>polar_function</option>
                        <option>randomsquares</option>
                        <option>ripple</option>
                        <option>rotate_scale_fade</option>
                        <option>squareswire</option>
                        <option>squeeze</option>
                        <option>swap</option>
                        <option>undulatingBurnOut</option>
                        <option>wind</option>
                        <option>windowblinds</option>
                        <option>windowslice</option>
                        <option>wipeDown</option>
                        <option>wipeLeft</option>
                        <option>wipeRight</option>
                        <option>wipeUp</option>
                    </select>
                </div>
                <div class="mt-3">
                    <h4 class="text-dark font-weight-bold">Duration</h4>
                    <label class="d-inline-flex">
                        <input type="number" class="border shadow-sm px-2 rounded" v-model="duration" min="200" max="2000" step="100">
                        <h6 class="text-dark font-weight-bold ml-1 pt-2">ms</h6>
                    </label>
                </div>
                <div class="mt-3">
                    <div class="custom-control custom-checkbox">
                        <input class="custom-control-input" type="checkbox" id="fl_transition" v-model="isFLTransition">
                        <label class="custom-control-label" for="fl_transition">
                            <h4 class="text-dark font-weight-bold">First-Last Transition</h4>
                    </label>
                    </div>
                </div>
                </div>
                <div class="bg-light p-3 rounded shadow-sm mt-3">
                <div class="custom-control custom-checkbox">
                    <input class="custom-control-input" type="checkbox" id="drawtext" v-model="isDrawText">
                    <label class="custom-control-label" for="drawtext">
                        <h4 class="text-dark font-weight-bold">Draw Text</h4>
                    </label>
                </div>
                <div class="mt-3">
                    <h4 class="text-dark font-weight-bold">fontsize</h4>
                    <input type="number" v-model="fontsize" class="border shadow-sm rounded" min="1" max="256" v-bind:disabled="!isDrawText">
                </div>
                <div class="mt-3">
                    <h4 class="text-dakr font-weight-bold">fontborder</h4>
                    <input type="number" v-model="borderw" class="border shadow-sm rounded" min="0" max="20" v-bind:disabled="!isDrawText">
                </div>
                <div class="mt-3">
                    <h4 class="text-dark font-weight-bold">fontcolor</h4>
                    <select v-model="fontcolor" class="form-control border shadow-sm rounded" v-bind:disabled="!isDrawText">
                        <option>white</option>
                        <option>black</option>
                        <option>blue</option>
                        <option>green</option>
                        <option>red</option>
                    </select>
                </div>
                <div class="mt-3">
                    <h4 class="text-dark font-weight-bold">position</h4>
                    <select v-model="position" class="form-control border shadow-sm rounded" v-bind:disabled="!isDrawText">
                        <option>top-left</option>
                        <option>top-right</option>
                        <option>bottom-left</option>
                        <option>bottom-right</option>
                    </select>
                </div>
                </div>
                </div>
                <div class="col-lg-4">
                    <div class="row mt-3 d-flex align-items-center justify-content-center">
                        <button class="btn btn-outline-primary btn-lg py-4 px-5 shadow-sm" v-bind:disabled="disabledCreateButton" v-on:click="postDigestInfo">
                        CREATE
                        </button>
                    </div>
                    <div class="row mt-2 d-flex align-items-center justify-content-center">
                        <ul style="list-style: none;">
                            <li v-show="this.userName.length == 0">
                                <i class="fas fa-times-circle text-danger"></i>
                                Logged-in
                            </li>
                            <li v-show="this.timelineClips.length <= 1">
                                <i class="fas fa-times-circle text-danger"></i>
                                Select clips
                            </li>
                            <li v-show="this.playTimeExceeded">
                                <i class="fas fa-times-circle text-danger"></i>
                                Video duration
                            </li>
                            <li v-show="this.title.length == 0">
                                <i class="fas fa-times-circle text-danger"></i>
                                Title
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- /DIGEST OPTION -->

    <!-- REQUESTED DIGEST AREA -->
    <section id="digest">
        <div class="row p-3 shadow section  bg-white">
            <div class="col-12">
                <h2 class="text-dark font-weight-bold">Highlight Videos</h2>
            </div>
            <div class="col-12">
                <p class="text-secondary mt-2">
                    <button class="btn btn-secondary ml-2" data-toggle="collapse" data-target="#digestNote"
                            aria-expand="false" aria-controls="digestNote">
                        <i class="fas fa-exclamation-circle pt-1" style="font-size: 1.3em"></i>
                        <span class="ml-1">Note</span>
                    </button>
                    <div class="collapse shadow-sm p-3 bg-light" id="digestNote">
                        <span class="d-block">
                            ・This process which create a highlights video takes more than 10 minutes.
                        </span>
                        <span class="d-block">
                            ・The highlights video is available for 7 days after requested.
                        </span>
                    </div>
                </p>
                <button class="btn btn-info" v-on:click="getHighlights"><i class="fas fa-sync"></i></button>
            </div>
            <!-- DIGEST TABLE -->
            <div class="table-responsive">
            <table class="table m-2 table-hover shadow-sm">
                <thead class="thead-light">
                    <tr>
                        <th>Title</th>
                        <th>Requested</th>
                        <th>Status</th>
                        <th>Restore</th>
                        <th>Download</th>
                    </tr>
                </thead>
                    <tr v-for="highlight in getHighlightsItems">
                        <td>
                            [[ highlight.title ]]
                        </td>
                        <td>
                            [[ formatRequested(highlight.created) ]]
                        </td>
                        <td>
                            <div class="text-secondary" v-if="highlight.status == 'Pending'">
                                <i class="fas fa-spinner faa-spin animated mr-1"></i>
                                [[ highlight.status ]]
                            </div>
                            <div class="text-secondary" v-else-if="highlight.status == 'Processing'">
                                <i class="fas fa-spinner faa-spin animated mr-1"></i>
                                [[ highlight.status ]]
                            </div>
                            <div class="text-dark" v-else-if="highlight.status == 'Expired'">
                                [[ highlight.status ]]
                            </div>
                            <div class="text-success font-weight-bold" v-else-if="highlight.status == 'Available'">
                                <i class="fas fa-check-circle mr-1"></i>
                                [[ highlight.status ]]
                            </div>
                            <div class="text-secondary" v-else>
                                <i class="fas fa-spinner faa-spin animated mr-1"></i>
                                [[ highlight.status ]]
                            </div>
                        </td>
                        <td>
                            <button class="btn btn-outline-success" v-on:click="restoreDigest(highlight)">
                                <i class="fas fa-wrench"></i>
                            </button>
                        </td>
                        <td>
                            <div class="" v-if="highlight.status == 'Available'">
                                <a v-on:click="openDigestModal(highlight.task_id)" style="cursor: pointer">
                                    <i class="fas fa-file-video faa-float animated shadow-sm text-twitch" style="font-size: 1.5em"></i>
                                </a>
                            </div>
                            <div class="" v-else>
                                -
                            </div>
                        </td>
                    </tr>
            </table>
            </div>
            <!-- /DIGEST TABLE -->
        </div>
        <div class="modal fade" id="digestModal" tabindex="-1" role="dialog" aria-labelledby="label1" aria-hidden="true">
                <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
                    <div class="modal-content bg-dark">
                        <div class="embed-responsive embed-responsive-16by9">
                        <video class="embed-responsive-item" v-bind:src="digestUrl" controls>
                        </video>
                    </div>
                    </div>
                </div>
            </div>
    </section>
    <!-- /REQUESTED DIGEST AREA -->
</div>
</div>
{% endblock %}

{% block extra_script %}
<script>
    const user_pk = "{{ request.user.pk }}";
    const username = "{{ request.user.username }}";
    const bucket_name = "{{ bucket_name }}";
    const highlight_url = "{% url 'highlight-list' %}";
    const task_url = "{% url 'task-list' %}";
    const autoclip_url = "{% url 'autoclip-list' %}";
    const studio_url = "{% url 'index' %}";
    const api_url = "{% url 'twitch_api' %}";
</script>
<script src="{% static 'app/js/twitch-api.js' %}"></script>
<script src="{% static 'app/js/studio.js' %}"></script>
{% endblock %}
